(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33c320e6"],{"0fea":function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return d}));var a=n("b775"),i={rolePage:"/system/role/findPage",roleInfo:"/system/role/get",removeRole:"/system/role/delete",getPermissonData:"/system/moduleAction/getPermissonData",roleList:"/system/role/findList",saveRole:"/system/role/save"};function r(e){return Object(a["b"])({url:i.roleList,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function s(e){return Object(a["b"])({url:i.rolePage,method:"post",data:e,headers:{"Content-Type":"application/json;charset=UTF-8"}})}function o(e){return Object(a["b"])({url:i.roleInfo,method:"post",data:e})}function c(e){return Object(a["b"])({url:i.removeRole,method:"post",data:e})}function l(e){return Object(a["b"])({url:i.getPermissonData,method:"post",data:e})}function d(e){return Object(a["b"])({url:i.saveRole,method:"post",data:e})}},"88bc":function(e,t,n){(function(t){var n=1/0,a=9007199254740991,i="[object Arguments]",r="[object Function]",s="[object GeneratorFunction]",o="[object Symbol]",c="object"==typeof t&&t&&t.Object===Object&&t,l="object"==typeof self&&self&&self.Object===Object&&self,d=c||l||Function("return this")();function u(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function m(e,t){var n=-1,a=e?e.length:0,i=Array(a);while(++n<a)i[n]=t(e[n],n,e);return i}function h(e,t){var n=-1,a=t.length,i=e.length;while(++n<a)e[i+n]=t[n];return e}var f=Object.prototype,p=f.hasOwnProperty,b=f.toString,v=d.Symbol,g=f.propertyIsEnumerable,y=v?v.isConcatSpreadable:void 0,w=Math.max;function D(e,t,n,a,i){var r=-1,s=e.length;n||(n=x),i||(i=[]);while(++r<s){var o=e[r];t>0&&n(o)?t>1?D(o,t-1,n,a,i):h(i,o):a||(i[i.length]=o)}return i}function k(e,t){return e=Object(e),_(e,t,(function(t,n){return n in e}))}function _(e,t,n){var a=-1,i=t.length,r={};while(++a<i){var s=t[a],o=e[s];n(o,s)&&(r[s]=o)}return r}function j(e,t){return t=w(void 0===t?e.length-1:t,0),function(){var n=arguments,a=-1,i=w(n.length-t,0),r=Array(i);while(++a<i)r[a]=n[t+a];a=-1;var s=Array(t+1);while(++a<t)s[a]=n[a];return s[t]=r,u(e,this,s)}}function x(e){return C(e)||I(e)||!!(y&&e&&e[y])}function L(e){if("string"==typeof e||F(e))return e;var t=e+"";return"0"==t&&1/e==-n?"-0":t}function I(e){return O(e)&&p.call(e,"callee")&&(!g.call(e,"callee")||b.call(e)==i)}var C=Array.isArray;function A(e){return null!=e&&N(e.length)&&!S(e)}function O(e){return R(e)&&A(e)}function S(e){var t=P(e)?b.call(e):"";return t==r||t==s}function N(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=a}function P(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function R(e){return!!e&&"object"==typeof e}function F(e){return"symbol"==typeof e||R(e)&&b.call(e)==o}var T=j((function(e,t){return null==e?{}:k(e,m(D(t,1),L))}));e.exports=T}).call(this,n("c8ba"))},"8a81":function(e,t,n){},b14e:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-card",{staticClass:"moduleCard"},[n("div",[n("div",{staticClass:"searchDiv"},[n("a-form",{attrs:{form:e.searchForm,"label-col":{span:5},"wrapper-col":{span:16}},on:{submit:e.handleSearch}},[n("a-row",{attrs:{gutter:24}},[n("a-col",{attrs:{span:8}},[n("a-form-item",{attrs:{label:"角色名称"}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name"],expression:"['name']"}],attrs:{placeholder:"请输入角色名称"}})],1)],1),n("a-col",{attrs:{span:8}},[n("a-form-item",{attrs:{label:"状态"}},[n("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["status"],expression:"['status']"}],attrs:{placeholder:"请选择状态"}},[n("a-select-option",{attrs:{value:"0"}},[e._v("全部")]),n("a-select-option",{attrs:{value:"1"}},[e._v("正常")]),n("a-select-option",{attrs:{value:"2"}},[e._v("禁用")])],1)],1)],1),n("a-col",{style:{textAlign:"right"},attrs:{span:8}},[n("a-button",{attrs:{type:"primary","html-type":"submit"}},[e._v(" 查询 ")]),n("a-button",{style:{marginLeft:"8px"},on:{click:e.handleReset}},[e._v(" 清空 ")])],1)],1)],1)],1),n("div",{staticClass:"addDiv"},[1===e.actionList.add?n("a-button",{staticStyle:{"margin-bottom":"20px"},attrs:{type:"primary"},on:{click:e.addDrawerShow}},[n("a-icon",{attrs:{type:"plus"}}),e._v(" 增加 ")],1):e._e()],1)]),n("div",{staticClass:"tableDiv"},[n("s-table",{ref:"table",attrs:{size:"default",columns:e.columns,data:e.loadData,pagination:e.pagination,rowKey:function(e){return e.id}},scopedSlots:e._u([{key:"operation",fn:function(t,a){return[1===e.actionList.update?n("a",{on:{click:function(t){return e.handleEdit(a)}}},[e._v(" 修改 ")]):e._e(),1===e.actionList.update&&1===e.actionList.get||1!==e.actionList.get?n("a-divider",{attrs:{type:"vertical"}}):e._e(),1===e.actionList.get?n("a",{on:{click:function(t){return e.handleRead(a)}}},[e._v(" 查看 ")]):e._e(),1===e.actionList.get||1===e.actionList.delete?n("a-divider",{attrs:{type:"vertical"}}):e._e(),1===e.actionList.delete?n("a-popconfirm",{attrs:{title:"您确定要删除吗?",okText:"确定",cancelText:"取消"},on:{confirm:function(t){return e.confirm(a)},cancel:e.cancel}},[n("a",{attrs:{href:"#"}},[e._v(" 删除 ")])]):e._e()]}}])})],1),n("div",[n("a-drawer",{attrs:{width:"80%",title:e.title,visible:e.visible,confirmLoading:e.addLoading,bodyStyle:{paddingBottom:"80px"}},on:{close:e.onClose}},[n("a-form",{attrs:{form:e.form,"label-col":{span:5},"wrapper-col":{span:16}},on:{submit:function(t){return e.handleSubmit(e.form)}}},[n("a-form-item",[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["id"],expression:"['id']"}],attrs:{hidden:"hidden"}})],1),n("a-form-item",{attrs:{label:"唯一键"}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["roleCode",{rules:[{required:!0,message:"请输入唯一码"}]}],expression:"['roleCode', {rules: [{required: true, message: '请输入唯一码'}]}]"}],attrs:{placeholder:"请输入唯一键"}})],1),n("a-form-item",{attrs:{label:"角色名称"}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["name",{rules:[{required:!0,message:"请输入角色名称"}]}],expression:"['name', {rules: [{required: true, message: '请输入角色名称'}]}]"}],attrs:{placeholder:"请输入角色名称"}})],1),n("a-form-item",{attrs:{label:"状态"}},[n("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["status"],expression:"['status']"}],attrs:{placeholder:"请选择状态"}},[n("a-select-option",{attrs:{value:1}},[e._v("正常")]),n("a-select-option",{attrs:{value:2}},[e._v("禁用")])],1)],1),n("a-form-item",{attrs:{label:"备注说明"}},[n("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{rules:[{required:!0,message:"备注说明不能为空"}]}],expression:"['description', {rules: [{required: true, message: '备注说明不能为空'}]}]"}],attrs:{row:3,id:"describe",placeholder:"请输入备注说明"}})],1),n("a-form-item",{attrs:{label:"拥有权限"}},[n("a-row",e._l(e.permissions,(function(t){return n("a-col",{key:t.permissionId,class:t.permissionId===e.current?"active":"",staticStyle:{cursor:"pointer","text-align":"center"},attrs:{span:4},on:{click:function(n){return e.addPermission(t)}}},[e._v(" "+e._s(t.name+"/"+t.description)+" ")])})),1),e._l(e.btnPer,(function(t,a){return n("a-row",{key:a,attrs:{gutter:24}},[n("a-col",{attrs:{xl:8,lg:24}},[n("a-checkbox",{attrs:{options:t.name},on:{change:function(n){return e.chooseName(t)}},model:{value:t.selectedName,callback:function(n){e.$set(t,"selectedName",n)},expression:"permission.selectedName"}},[e._v(" "+e._s(t.name)+"： ")])],1),t.actionData.length>0?n("a-col",{attrs:{xl:16,lg:24}},[n("a-checkbox",{attrs:{indeterminate:t.indeterminate,checked:t.checkedAll,disabled:!t.selectedName},on:{change:function(n){return e.onChangeCheckAll(n,t)}}},[e._v(" 全选 ")]),n("a-checkbox-group",{attrs:{options:t.actionData,disabled:!t.selectedName},on:{change:function(n){return e.onChangeCheck(t)}},model:{value:t.selected,callback:function(n){e.$set(t,"selected",n)},expression:"permission.selected"}})],1):e._e()],1)}))],2)],1),n("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[n("a-button",{style:{marginRight:"8px"},on:{click:e.onClose}},[e._v(" 取消 ")]),n("a-button",{attrs:{type:"primary","html-type":"submit",disabled:e.saveDisabled},on:{click:e.handleSubmit}},[e._v("保存")])],1)],1)],1),n("div",[n("a-drawer",{attrs:{width:800,title:e.readTitle,visible:e.visibleRead,confirmLoading:e.readLoading,bodyStyle:{paddingBottom:"80px"}},on:{close:e.onReadClose}},[n("a-card",{attrs:{bordered:!0,title:"基本信息",size:"small"}},[n("detail-list",{attrs:{col:3}},[n("detail-list-item",{attrs:{term:"唯一键"}},[e._v(e._s(e.obj.roleCode))]),n("detail-list-item",{attrs:{term:"角色名"}},[e._v(e._s(e.obj.name))]),n("detail-list-item",{attrs:{term:"状态"}},[e._v(e._s(1==e.obj.status?"启用":"禁用"))])],1),n("detail-list",{attrs:{col:1}},[n("detail-list-item",{attrs:{term:"备注说明"}},[e._v(" "+e._s(e.obj.description)+" ")])],1),n("detail-list",{attrs:{col:1}},[n("detail-list-item",{attrs:{term:"拥有权限"}},[n("a-row",{style:{marginBottom:"12px"},attrs:{gutter:24}},e._l(e.obj.permissions,(function(t,a){return n("a-col",{key:a,style:{marginBottom:"12px"},attrs:{span:24}},[n("a-col",{attrs:{lg:6,md:24}},[n("span",[e._v(e._s(t.name+(t.description?"/"+t.description:""))+"：")])]),t.actionData.length>0?n("a-col",{attrs:{lg:18,md:24}},e._l(t.actionData,(function(t,a){return n("a-tag",{key:a,attrs:{color:"cyan"}},[e._v(e._s(t.describe))])})),1):n("a-col",{attrs:{span:18}},[e._v("-")])],1)})),1)],1)],1)],1)],1)],1)])},i=[],r=(n("99af"),n("4de4"),n("4160"),n("d81d"),n("b0c0"),n("ac1f"),n("1276"),n("159b"),n("a4d3"),n("e01a"),n("d28b"),n("e260"),n("d3b7"),n("3ca3"),n("ddb0"),n("06c5"));function s(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Object(r["a"])(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i,s=!0,o=!1;return{s:function(){a=e[Symbol.iterator]()},n:function(){var e=a.next();return s=e.done,e},e:function(e){o=!0,i=e},f:function(){try{s||null==a["return"]||a["return"]()}finally{if(o)throw i}}}}var o=n("5530"),c=n("2af9"),l=n("0fea"),d=n("88bc"),u=n.n(d),m=n("de15"),h=n("322e"),f=n("5880"),p=m["a"].Item,b={name:"TableList",components:{AFormItem:h["a"],STable:c["g"],DetailList:m["a"],DetailListItem:p},data:function(){var e=this;return{obj:{},saveDisabled:!1,searchForm:this.$form.createForm(this),form:this.$form.createForm(this),title:"",readTitle:"",visible:!1,visibleRead:!1,addLoading:!1,readLoading:!1,loading:!1,actionList:{},pagination:{showSizeChanger:!0,showQuickJumper:!0,pageSize:10,showTotal:function(e,t){return"第".concat(t[0],"-").concat(t[1],"条")+" "+"共 ".concat(e," 条记录")}},mdl:{},permissions:[],btnPer:[],current:"",queryParam:{},columns:[{title:"唯一识别码",dataIndex:"roleCode",key:"roleCode",align:"center",ellipsis:!0},{title:"角色名称",dataIndex:"name",key:"name",align:"center",ellipsis:!0},{title:"状态",dataIndex:"status",key:"status",align:"center",ellipsis:!0},{title:"创建时间",dataIndex:"createTime",key:"createTime",align:"center",ellipsis:!0},{title:"操作",dataIndex:"operation",scopedSlots:{customRender:"operation"},align:"center",ellipsis:!0}],loadData:function(t){return Object.assign(t,e.queryParam),Object(l["d"])(t).then((function(e){return e.result}))},selectedRowKeys:[],selectedRows:[]}},created:function(){var e=this;this.loadPermissions();var t=this.$route.path.split("/").pop(),n=this.roles.permissions.filter((function(e){return e.permissionId===t}));n=n[0].actionList,n.forEach((function(t){"add"===t?e.actionList.add=1:"get"===t?e.actionList.get=1:"update"===t?e.actionList.update=1:"delete"===t&&(e.actionList.delete=1)}))},computed:Object(o["a"])({},Object(f["mapState"])({roles:function(e){return e.user.roles}})),methods:{addPermission:function(e){this.current=e.permissionId,0===e.children.length?this.btnPer=[e]:this.btnPer=e.children},chooseName:function(e){e.selectedName||this.permissions.forEach((function(t,n,a){t.children&&0===t.children.length?t.permissionId===e.permissionId&&(a[n].selected=[],a[n].checkedAll=!1,a[n].indeterminate=!1):t.children.forEach((function(t,n,a){t.permissionId===e.permissionId&&(a[n].selected=[],a[n].checkedAll=!1,a[n].indeterminate=!1)}))}))},handleSearch:function(e){var t=this;e.preventDefault(),this.searchForm.validateFields((function(e,n){e||(t.queryParam={entity:{status:n.status,name:n.name}},t.$refs.table.refresh(!0))}))},handleReset:function(e){this.searchForm.resetFields()},addDrawerShow:function(e){this.title="添加角色",this.visible=!0,this.addPermission(this.permissions[0])},handleEdit:function(e){var t=this;this.addPermission(this.permissions[0]);var n={id:e.id};Object(l["b"])(n).then((function(e){t.form.setFieldsValue(u()(e.result,"id","roleCode","name","status","description")),t.permissions.forEach((function(t,n,a){t.children&&0===t.children.length?e.result.permissions.forEach((function(e){t.permissionId===e.permissionId&&(a[n].selected=e.actionData.map((function(e){return e.action})),a[n].indeterminate=e.actionData.length>0&&t.actionData.length!==e.actionData.length,a[n].selectedName=!0,a[n].checkedAll=t.actionData.length===e.actionData.length)})):t.children.forEach((function(i,r){e.result.permissions.forEach((function(e){i.permissionId===e.permissionId&&(a[n].children[r].selected=e.actionData.map((function(e){return e.action})),a[n].children[r].indeterminate=e.actionData.length>0&&t.children[r].actionData.length!==e.actionData.length,a[n].children[r].selectedName=!0,a[n].children[r].checkedAll=t.children[r].actionData.length===e.actionData.length)}))}))}))})),this.visible=!0,this.title="修改角色信息"},handleSubmit:function(e){var t=this;e.preventDefault(),this.saveDisabled=!0,this.confirmLoading=!0,this.form.validateFields((function(e,n){if(e)t.saveDisabled=!1,t.form.option.focus=!0,t.confirmLoading=!1,t.form.resetFields();else{var a=0,i=[];t.permissions.forEach((function(e){0===e.children.length?e.selectedName&&i.push(e):(a=0,e.children.forEach((function(t){t.selectedName&&(a++,1===a&&i.push({name:e.name,permissionId:e.permissionId}),i.push(t))})))}));var r=[];i.forEach((function(t){var n={};n.permissionId=t.permissionId,n.name=t.name,t.selected&&t.selected.length>0&&(n.actionData=t.actionData.map((function(n){var a,i=s(t.selected);try{for(i.s();!(a=i.n()).done;){var r=a.value;if(n.value===r)return{action:n.value,describe:n.label}}}catch(e){i.e(e)}finally{i.f()}})),n.actionData=n.actionData.filter((function(e){return e}))),r.push(n)})),r=r.filter((function(e){return e})),n.permissionDtoList=r,Object(l["f"])(n).then((function(e){1===e.code?(t.$message.success("保存成功"),t.form.resetFields(),t.$refs.table.refresh(!0),t.visible=!1,t.saveDisabled=!1):(t.$message.error(e.message),t.saveDisabled=!1),t.loadPermissions()}))}}))},onClose:function(e){this.visible=!1,this.form.resetFields(),this.permissions=this.permissions.map((function(e,t,n){return e.children&&0===e.children.length?(e.selectedName=!1,e.selected=[],e.indeterminate=!1,e.checkedAll=!1,e):(e.children=e.children.map((function(e){return e.selectedName=!1,e.selected=[],e.indeterminate=!1,e.checkedAll=!1,e})),e)}))},handleRead:function(e){var t=this;this.readTitle="查看角色信息";var n={id:e.id};Object(l["b"])(n).then((function(e){t.obj=e.result})),this.visibleRead=!0},onReadClose:function(){this.visibleRead=!1},confirm:function(e){var t=this,n={id:e.id};Object(l["e"])(n).then((function(e){1===e.code?t.$success({title:"提示信息",content:"删除成功",onOk:function(){return t.$refs.table.refresh(!0)}}):t.$error({title:"提示信息",content:"删除失败"+e.message})}))},cancel:function(e){this.$message.info("已取消删除")},onChange:function(e,t){this.selectedRowKeys=e,this.selectedRows=t},okHandle:function(){this.$refs.table.refresh(!0),this.visible=!1},toggleAdvanced:function(){this.advanced=!this.advanced},onChangeCheck:function(e){e.indeterminate=!!e.selected.length&&e.selected.length<e.actionData.length,e.checkedAll=e.selected.length===e.actionData.length},onChangeCheckAll:function(e,t){Object.assign(t,{selected:e.target.checked?t.actionData.map((function(e){return e.value})):[],indeterminate:!1,checkedAll:e.target.checked})},loadPermissions:function(){var e=this;Object(l["a"])().then((function(t){if(1===t.code){var n=t.result;e.permissions=n.map((function(e){return 0===e.children.length?(e.selectedName=!1,e.checkedAll=!1,e.indeterminate=!1,e.selected=[],e.actionData=e.actionData.map((function(e){return{label:e.describe,value:e.action}})),e):(e.children=e.children.map((function(e){return e.selectedName=!1,e.checkedAll=!1,e.indeterminate=!1,e.selected=[],e.actionData=e.actionData.map((function(e){return{label:e.describe,value:e.action}})),e})),e)}))}else e.$message.error(t.message)}))}}},v=b,g=(n("f687"),n("2877")),y=Object(g["a"])(v,a,i,!1,null,"3260949a",null);t["default"]=y.exports},f687:function(e,t,n){"use strict";var a=n("8a81"),i=n.n(a);i.a}}]);